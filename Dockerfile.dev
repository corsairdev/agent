FROM node:22-slim

# Build tools required by @whiskeysockets/baileys (native modules)
RUN apt-get update && apt-get install -y \
    build-essential \
    python3 \
    git \
    && rm -rf /var/lib/apt/lists/*

RUN npm install -g pnpm

WORKDIR /app

# Install dependencies in a separate layer so Docker caches it.
# This layer only rebuilds when package.json or pnpm-lock.yaml changes.
COPY package.json pnpm-lock.yaml ./
RUN pnpm install

# Source code is NOT copied here â€” it's mounted at runtime via docker-compose.
# Edits on the host are reflected immediately inside the container.
